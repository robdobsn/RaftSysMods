/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// BLE Bus Handler
//
// Rob Dobson 2024
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "Logger.h"
#include "BusBLE.h"
#include "RaftJsonPrefixed.h"

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// @brief Constructor
BusBLE::BusBLE(BusElemStatusCB busElemStatusCB, BusOperationStatusCB busOperationStatusCB)
    : RaftBus(busElemStatusCB, busOperationStatusCB),
        _bleBusDeviceManager(*this)
{
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// @brief Destructor
BusBLE::~BusBLE()
{
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// @brief Setup
/// @param config Configuration
/// @return true if successful
bool BusBLE::setup(const RaftJsonIF& config)
{
    // Get bus details
    _busName = config.getString("name", "");

    // Bus status manager
    _bleBusDeviceManager.setup(config);

    // Debug
    LOG_I(MODULE_PREFIX, "setup name %s", _busName.c_str());

    // Ok
    return true;
}
